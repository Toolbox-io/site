import{Utils}from"../common.js";var id=Utils.id;var query=Utils.query;(()=>{const e=id("loginForm");const t=id("username");const s=id("password");const n=query(".auth-button");const a=id("error-message");e.addEventListener("submit",(async function(e){e.preventDefault();const o=t.value;const i=s.value;a.style.display="none";n.disabled=true;n.textContent="Logging in...";try{const e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:i})});const t=await e.json();if(e.ok){localStorage.setItem("authToken",t.access_token);window.dispatchEvent(new Event("authStateChanged"));a.textContent="Login successful! Redirecting...";a.className="success-message";a.style.display="block";setTimeout((()=>{window.location.href="/account"}),1e3)}else{a.textContent=t.detail||"Login failed";a.className="error-message";a.style.display="block"}}catch(e){a.textContent="Network error. Please try again.";a.className="error-message";a.style.display="block"}finally{n.disabled=false;n.textContent="Login"}}))})();